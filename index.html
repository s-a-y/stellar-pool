<hmtl>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Stellar mining pool</title>
    <script src="bower_components/jquery/dist/jquery.min.js" type="text/javascript"></script>
    <script src="bower_components/jquery-cookie/jquery.cookie.js" type="text/javascript"></script>
    <script src="bower_components/stellar-0.9.2-debug.js" type="text/javascript"></script>
    <script src="bower_components/bootstrap/js/collapse.js" type="text/javascript"></script>
    <link href="bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet"/>
  </head>
  <body>
  <div class="container" role="main">
    <div class="alert" role="alert" style="display: none;" id="message"></div>
    <div class="col-sm-6 col-xs-12" style="margin-top: 20px;">
      <div class="panel panel-default">
        <div class="panel-body">
          <p class="lead">Estimated time of next Inflation:<br/>
            Unix Timestamp: 1407529303<br/>
            08 August 2014 8:21:43pm UTC</p>
          <p>I may be wrong, so, please, check my calculations</p>
        </div>
      </div>

        <div class="panel panel-default">
          <div class="panel-heading"><b>Check if you are currently in the pool</b></div>
          <div class="panel-body">
        <form class="form-horizontal" id="check">
          <div class="input-group">
            <input class="form-control input-lg" type="text" placeholder="Your stellar address" name="account" id="address">
            <span class="input-group-btn">
              <button class="btn btn-lg btn-primary" type="submit">Check</button>
            </span>
          </div>
        </form>
          </div>
        </div>
      <div class="panel panel-default">
        <div class="panel-heading"><b>Join pool</b></div>
        <div class="panel-body">
        <p class="lead">For those, who cannot execute command locally on their computer for some reason.</p>
        <p class="alert alert-danger">Attention! Never enter you secret key anywhere in the internet, e.g. forms like this one.<br/> I'm not gonna steal anyone's keys, but others may. <br/>Functionality offered without warranty of any kind</p>
        <form class="form-horizontal" id="form">
          <div class="form-group">
            <label for="account" class="col-sm-2 control-label">Account</label>
            <div class="col-sm-10">
              <input class="form-control" type="text" placeholder="Your stellar address" name="account" id="account">
            </div>
          </div>
          <div class="form-group">
            <label for="secret" class="col-sm-2 control-label">Secret</label>
            <div class="col-sm-10">
              <input class="form-control" type="password" placeholder="Your stellar secret" name="secret" id="secret">
            </div>
          </div>
          <button class="btn btn-lg btn-success" type="submit">Join us!</button>
        </form>
        </div>
      </div>
      </div>
    <div class="col-sm-6 col-xs-12" style="margin-top: 20px;">
      <!--<div class="panel panel-default">-->
        <!--<div class="panel-heading"><b>Latest news</b></div>-->
        <!--<div class="panel-body">-->
          <!---->
        <!--</div>-->
      <!--</div>-->
      <h3>FAQ</h3>
      <div class="panel-group" id="accordion">
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapseOne">
                How it works?
              </a>
            </h4>
          </div>
          <div id="collapseOne" class="panel-collapse collapse in">
            <div class="panel-body">
              <p>Stellar has Inflation (1% per annum), which distributed weekly between 50 most voted accounts (or less if any of them passes 1.5% of total STR number).</p>
              <p>We join together and vote for the same account to get the credit. If our pool is among the winners of Inflation credit - reward will be distributed between pool members proportionally to their voting power.</p>
              <p>Voting power is your wallet balance at the moment of Inflation distribution.</p>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapseOnePointHalf">
                How to join
              </a>
            </h4>
          </div>
          <div id="collapseOnePointHalf" class="panel-collapse collapse">
            <div class="panel-body">
              Recommended way to join the pool is to run console command on your computer
              <pre>
curl -X POST https://live.stellar.org:9002 -d '{
  "method": "submit",
  "params": [{
    "secret": "Your secret goes here",
    "tx_json": {
      "Account": "You address goes here",
      "InflationDest": "gaj43wzt5XD8fz6JfbnaVQsewLtdfU5cFK",
      "TransactionType": "AccountSet"
    }
  }]
}'</pre>
              <p>You can find your address inside the wallet client if you go to "Receive" -> "Show your Stellar address"
              To find secret click to your username in top-right corner and there in the settings "Reveal" your secret key.</p>

              <p>To execute it on windows, you may need to install Git: http://git-scm.com/download/win
              and then open PowerShell console to run the command. (maybe escape every quotes with backslash, like \"method\": \"submit\"...)</p>

              <div class="alert alert-info">If you are a girl or not technical person - just use the form "Join the pool" on this page.
                However it's not recommended, because it requires your secret key - information which you should keep private and never share with anyone in the internet</div>
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapseTwo">
                Who's running the pool?
              </a>
            </h4>
          </div>
          <div id="collapseTwo" class="panel-collapse collapse">
            <div class="panel-body">
              I'm Software developer and Enterpreneur, interested in Bitcoin and other rivals. Ripple was one of my favorites before Stellar.<br/>
              Currently this page is far from perfect, because I have extreme lack of time.
              <a href="https://stellartalk.org/user/662-umbrel/">Find me on Stellartalk.org</a><br/>
              <a href="https://github.com/s-a-y/stellar-pool">This website on GitHub</a> (feel free to create issues and contribute)
            </div>
          </div>
        </div>
        <div class="panel panel-default">
          <div class="panel-heading">
            <h4 class="panel-title">
              <a data-toggle="collapse" data-parent="#accordion" href="#collapseThree">
                What are future plans for this?
              </a>
            </h4>
          </div>
          <div id="collapseThree" class="panel-collapse collapse">
            <div class="panel-body">
              <p>I'm interested to see if we can win the Inflation challenge, and if reward worth it.</p>
              <p>If experiment will be successful - I'll be developing this pool further, tons of things could be done:
              Voting power stats, Stellar network list of leaders by voting power, graphs and other analytics.</p>
              <p>For time being everything is free. Members will get 100% of rewarded Stellars, but I don't exclude possibility to switch to commercial basis in the future.</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
      (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
      m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

    ga('create', 'UA-53634406-1', 'auto');
    ga('send', 'pageview');

    $(function() {
      if($.cookie("address")) ga('set', '&uid', $.cookie("address"));

      $(document).on("submit", "#form", function() {
        var uid = $("input[name=account]").val().trim();
        $.cookie("address", uid);
        ga('set', '&uid', uid);
        $.post("https://live.stellar.org:9002", "{\"method\":\"submit\",\"params\":[{\"secret\": \""+
          $("input[name=secret]").val().trim()+"\",\"tx_json\":{\"TransactionType\":\"AccountSet\",\"Account\":\""+
          uid+"\",\"InflationDest\":\"gaj43wzt5XD8fz6JfbnaVQsewLtdfU5cFK\"}}]}",
          function(data) {
            if(data.result.status == "success") {
              $("#message").addClass("alert-success").html("You successfully joined the pool from account "+uid).show();

            } else {
              $("#message").addClass("alert-danger").html("Error occured, check your account address and secret key, if everything correct - let me know about the problem to s@umbrellab.com").show();
              console.log(data);
            }
          }, "json"
        );
        return false;
      })
        .on("submit", "#check", function() {
          var uid = $("#address").val().trim();
          $.cookie("address", uid);
          ga('set', '&uid', uid);
          var Remote = stellar.Remote;
          var remote = new Remote({
            "trusted" : true,
            "websocket_ip" : "live.stellar.org",
            "websocket_port" : 9001,
            "websocket_ssl" : true
          }, true);
          remote.connect(function() {
            remote.requestAccountTx({
              account: $("#address").val().trim(),
              descending: true,
              limit: 200
            }, function(er, data) {
              var tx = data.transactions;
              for(i in tx) {
                if(tx[i].tx.TransactionType == "AccountSet" && tx[i].tx.Account == uid) {
                  if(tx[i].tx.InflationDest == "gaj43wzt5XD8fz6JfbnaVQsewLtdfU5cFK") {
                    $("#message").addClass("alert-success").html("Yes, you are in the pool").show();
                  } else {
                    $("#message").addClass("alert-danger").html("No, you currently vote for "+tx[i].tx.InflationDest).show();
                  }
                  return;
                }
              }
              $("#message").addClass("alert-info").html("Unable to determine, check address correctness. Or maybe transaction history is too long.").show();
            });
          });
          return false;
        });

    });
  </script>
  </body>
</hmtl>